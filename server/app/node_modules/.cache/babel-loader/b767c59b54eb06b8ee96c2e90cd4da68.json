{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\donov\\\\Desktop\\\\Projeto GitHub WebSocket Webchat\\\\webchat_donovan\\\\server\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"C:\\\\Users\\\\donov\\\\Desktop\\\\Projeto GitHub WebSocket Webchat\\\\webchat_donovan\\\\server\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\donov\\\\Desktop\\\\Projeto GitHub WebSocket Webchat\\\\webchat_donovan\\\\server\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\donov\\\\Desktop\\\\Projeto GitHub WebSocket Webchat\\\\webchat_donovan\\\\server\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\donov\\\\Desktop\\\\Projeto GitHub WebSocket Webchat\\\\webchat_donovan\\\\server\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\donov\\\\Desktop\\\\Projeto GitHub WebSocket Webchat\\\\webchat_donovan\\\\server\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\donov\\\\Desktop\\\\Projeto GitHub WebSocket Webchat\\\\webchat_donovan\\\\server\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\donov\\\\Desktop\\\\Projeto GitHub WebSocket Webchat\\\\webchat_donovan\\\\server\\\\app\\\\src\\\\views\\\\webchat-component.js\";\nimport React from 'react';\nimport context from '../services/context';\nimport '../assets/css/webchat.scss';\nimport obj from '../services/loading';\nimport { SOCKETIP } from '../services/server-access-configuration';\nimport openSocket from 'socket.io-client';\nimport { get } from 'https';\n\nvar $ = require('jquery');\n\nvar WebChat =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(WebChat, _React$Component);\n\n  function WebChat(props) {\n    var _this;\n\n    _classCallCheck(this, WebChat);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(WebChat).call(this, props));\n    _this.state = {\n      message: '',\n      messages: [],\n      to: 'todos',\n      usersconnected: []\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.sendMessage = _this.sendMessage.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.socket = openSocket(SOCKETIP);\n    _this.message = React.createRef();\n    _this.to = React.createRef();\n    return _this;\n  }\n\n  _createClass(WebChat, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      (function (self, obj) {\n        if (!self.context.username) {\n          window.location.href = \"#/\";\n          alert('Por favor, logue novamente para continuar!');\n          return false;\n        }\n\n        self.socket.on('welcome', function (data) {\n          obj.closeLoading();\n          var username = self.context.username;\n          var date = new Date();\n          var result_date = date.getDate() + \"/\" + (date.getMonth() + 1) + \"/\" + date.getFullYear() + \" \" + date.getHours() + \":\" + date.getMinutes() + \":\" + date.getSeconds();\n          var send = {\n            from: username,\n            message: data,\n            first: true,\n            date: result_date,\n            to: 'todos'\n          };\n          self.socket.emit('register_username', username);\n          self.socket.emit('send_message', JSON.stringify(send), 'todos');\n        });\n        self.socket.on('receive_message', function (data) {\n          var result = JSON.parse(data);\n          self.setState({\n            messages: []\n          });\n          self.setState({\n            messages: result\n          });\n        });\n        self.socket.on('get_usersconnected', function (data) {\n          var result = JSON.parse(data);\n          result.push('todos');\n          self.setState({\n            usersconnected: []\n          });\n          self.setState({\n            usersconnected: result\n          });\n          console.warn(self.state.usersconnected);\n        });\n      })(this, obj);\n    }\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(event) {\n      var target = event.target,\n          name = target.name,\n          value = target.value;\n      this.setState(_defineProperty({}, name, value));\n    }\n  }, {\n    key: \"sendMessage\",\n    value: function sendMessage() {\n      if (!this.state.message) {\n        return;\n      }\n\n      var date = new Date();\n      var result_date = date.getDate() + \"/\" + (date.getMonth() + 1) + \"/\" + date.getFullYear() + \" \" + date.getHours() + \":\" + date.getMinutes() + \":\" + date.getSeconds();\n      var index = this.to.current.selectedIndex;\n      var to_ = this.to.current.children[index].textContent;\n      var send = {\n        from: this.context.username,\n        message: this.state.message,\n        to: to_,\n        date: result_date\n      };\n      window.alert(send.to);\n      this.socket.emit('send_message', JSON.stringify(send));\n      this.setState({\n        message: ''\n      });\n      this.message.current.focus();\n    }\n  }, {\n    key: \"onKeyDown_Message\",\n    value: function onKeyDown_Message(event) {\n      (function (self, event) {\n        if (event.ctrlKey && event.keyCode == 13) {\n          self.sendMessage();\n        }\n      })(this, event);\n    }\n  }, {\n    key: \"componentDidCatch\",\n    value: function componentDidCatch() {\n      $(\"footer\").removeClass(\"footer-fixed\");\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var state = this.state;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container-messages--style\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, state.messages.map(function (m, key) {\n        {\n          if (m.from === _this2.context.username && m.to !== 'todos') return React.createElement(\"div\", {\n            key: key,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178\n            },\n            __self: this\n          }, React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            style: {\n              color: 'red'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178\n            },\n            __self: this\n          }, m.from), \" \", React.createElement(\"b\", {\n            style: {\n              color: 'indigo'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178\n            },\n            __self: this\n          }, \"disse em privado para \", m.to), \" : \", React.createElement(\"span\", {\n            style: {\n              color: 'orange'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178\n            },\n            __self: this\n          }, m.message, \" - \", React.createElement(\"span\", {\n            style: {\n              color: 'red'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178\n            },\n            __self: this\n          }, m.date))));\n          if (m.from !== _this2.context.username && m.to === _this2.context.username) return React.createElement(\"div\", {\n            key: key,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 180\n            },\n            __self: this\n          }, React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 180\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            style: {\n              color: 'red'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 180\n            },\n            __self: this\n          }, m.to), \" \", React.createElement(\"b\", {\n            style: {\n              color: 'indigo'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 180\n            },\n            __self: this\n          }, \"disse em privado para voc\\xEA\"), \" : \", React.createElement(\"span\", {\n            style: {\n              color: 'orange'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 180\n            },\n            __self: this\n          }, m.message, \" - \", React.createElement(\"span\", {\n            style: {\n              color: 'red'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 180\n            },\n            __self: this\n          }, m.date))));else if (m.first) return React.createElement(\"div\", {\n            key: key,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 182\n            },\n            __self: this\n          }, React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 182\n            },\n            __self: this\n          }, React.createElement(\"b\", {\n            style: {\n              color: 'black'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 182\n            },\n            __self: this\n          }, \"Servidor\"), \" disse: \", React.createElement(\"b\", {\n            style: {\n              color: 'orange'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 182\n            },\n            __self: this\n          }, m.from), \" entrou na sala! - \", React.createElement(\"span\", {\n            style: {\n              color: 'red'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 182\n            },\n            __self: this\n          }, m.date)));else if (m.disconnected && m.from) return React.createElement(\"div\", {\n            key: key,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 184\n            },\n            __self: this\n          }, React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 184\n            },\n            __self: this\n          }, React.createElement(\"b\", {\n            style: {\n              color: 'black'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 184\n            },\n            __self: this\n          }, \"Servidor\"), \" disse: \", React.createElement(\"b\", {\n            style: {\n              color: 'orange'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 184\n            },\n            __self: this\n          }, m.from), \" saiu da sala! - \", React.createElement(\"span\", {\n            style: {\n              color: 'red'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 184\n            },\n            __self: this\n          }, m.date)));else if (m.from) return React.createElement(\"div\", {\n            key: key,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186\n            },\n            __self: this\n          }, React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            style: {\n              color: 'red'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186\n            },\n            __self: this\n          }, m.from), \" disse para \", React.createElement(\"span\", {\n            style: {\n              color: 'indigo'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186\n            },\n            __self: this\n          }, m.to), \": \", React.createElement(\"span\", {\n            style: {\n              color: 'orange'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186\n            },\n            __self: this\n          }, m.message, \" - \", React.createElement(\"span\", {\n            style: {\n              color: 'red'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186\n            },\n            __self: this\n          }, m.date))));\n        }\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }))))), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, \"Bem vindo: \", React.createElement(\"b\", {\n        style: {\n          color: 'Red'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, this.context.username)))), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, \"Enviar mensagem para:\", React.createElement(\"select\", {\n        ref: this.to,\n        onChange: this.handleChange,\n        name: \"to\",\n        className: \"form-control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, state.usersconnected.map(function (res, key) {\n        if (res !== _this2.context.username) return React.createElement(\"option\", {\n          value: key,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 213\n          },\n          __self: this\n        }, res);\n      }))))), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(\"textarea\", {\n        value: state.message,\n        ref: this.message,\n        onKeyDown: this.onKeyDown_Message.bind(this),\n        onChange: this.handleChange,\n        name: \"message\",\n        autoFocus: \"autoFocus\",\n        maxLength: \"1000\",\n        cols: \"10\",\n        rows: \"10\",\n        className: \"form-control\",\n        placeHolder: \"Publique alguma coisa - Ctrl + Enter para enviar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }))), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.sendMessage,\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, \"Enviar\"))));\n    }\n  }]);\n\n  return WebChat;\n}(React.Component);\n\nWebChat.contextType = context;\nWebChat.defaultProps = {};\nexport { WebChat as default };","map":{"version":3,"sources":["C:\\Users\\donov\\Desktop\\Projeto GitHub WebSocket Webchat\\webchat_donovan\\server\\app\\src\\views\\webchat-component.js"],"names":["React","context","obj","SOCKETIP","openSocket","get","$","require","WebChat","props","state","message","messages","to","usersconnected","handleChange","bind","sendMessage","socket","createRef","self","username","window","location","href","alert","on","data","closeLoading","date","Date","result_date","getDate","getMonth","getFullYear","getHours","getMinutes","getSeconds","send","from","first","emit","JSON","stringify","result","parse","setState","push","console","warn","event","target","name","value","index","current","selectedIndex","to_","children","textContent","focus","ctrlKey","keyCode","removeClass","map","m","key","color","disconnected","res","onKeyDown_Message","Component","contextType","defaultProps"],"mappings":"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","sourcesContent":["\r\nimport React from 'react';\r\nimport context from '../services/context';\r\nimport '../assets/css/webchat.scss';\r\nimport obj from '../services/loading';\r\nimport {SOCKETIP as SOCKETIP} from '../services/server-access-configuration';\r\n\r\nimport openSocket from 'socket.io-client';\r\nimport { get } from 'https';\r\nvar $ = require('jquery');\r\n\r\nexport default class WebChat extends React.Component {\r\n\r\n    static contextType = context;\r\n\r\n    static defaultProps = { }\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n    \r\n        this.state = { \r\n            message:'',\r\n            messages:[],\r\n            to:'todos',\r\n            usersconnected:[],\r\n        };\r\n\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.sendMessage = this.sendMessage.bind(this);\r\n        this.socket = openSocket(SOCKETIP);\r\n        this.message = React.createRef();\r\n        this.to = React.createRef();\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n\r\n         (function(self,obj) {\r\n\r\n            if(!self.context.username) {\r\n                window.location.href = \"#/\";\r\n                alert('Por favor, logue novamente para continuar!');\r\n                return false;\r\n            }\r\n\r\n            self.socket.on('welcome',function(data) {\r\n                obj.closeLoading();\r\n\r\n                let username = self.context.username;\r\n                let date = new Date();\r\n                let result_date = date.getDate() + \r\n                                        \"/\" +\r\n                                         (date.getMonth() + 1) + \r\n                                         \"/\" + \r\n                                         date.getFullYear() + \r\n                                         \" \" + \r\n                                         date.getHours() + \r\n                                         \":\" + \r\n                                         date.getMinutes() + \r\n                                         \":\" + \r\n                                         date.getSeconds();\r\n\r\n                \r\n                var send = {\r\n                    from:username,\r\n                    message:data,\r\n                    first:true,\r\n                    date:result_date,\r\n                    to:'todos'\r\n                };\r\n\r\n                self.socket.emit('register_username',username);\r\n                self.socket.emit('send_message',JSON.stringify(send),'todos');\r\n            });\r\n\r\n            self.socket.on('receive_message',(data) => {\r\n\r\n                var result = JSON.parse(data);\r\n                self.setState({messages:[]});\r\n                self.setState({messages:result});\r\n    \r\n            });\r\n\r\n            self.socket.on('get_usersconnected',(data) => {\r\n\r\n                var result = JSON.parse(data);\r\n                result.push('todos');\r\n                self.setState({usersconnected:[]});\r\n                self.setState({usersconnected:result});\r\n\r\n                console.warn(self.state.usersconnected);\r\n            });\r\n\r\n         })(this,obj);   \r\n    }\r\n\r\n    handleChange(event) {\r\n        const target = event.target,\r\n              name = target.name,\r\n              value = target.value;\r\n\r\n        this.setState({[name]:value});\r\n    }\r\n\r\n    sendMessage() {\r\n\r\n        if (!this.state.message) {\r\n            return;\r\n        }\r\n\r\n        let date = new Date();\r\n        let result_date = date.getDate() + \r\n                                \"/\" +\r\n                                 (date.getMonth() + 1) + \r\n                                 \"/\" + \r\n                                 date.getFullYear() + \r\n                                 \" \" + \r\n                                 date.getHours() + \r\n                                 \":\" + \r\n                                 date.getMinutes() + \r\n                                 \":\" + \r\n                                 date.getSeconds();\r\n\r\n        let index = this.to.current.selectedIndex;\r\n        let to_ = this.to.current.children[index].textContent;\r\n\r\n\r\n        let send = {\r\n            from:this.context.username,\r\n            message:this.state.message,\r\n            to:to_,\r\n            date:  result_date\r\n        };\r\n\r\n        window.alert(send.to);\r\n\r\n        this.socket.emit('send_message',JSON.stringify(send));\r\n\r\n        this.setState({message:''});\r\n        this.message.current.focus();\r\n    }\r\n\r\n    onKeyDown_Message(event) {\r\n\r\n        (function(self,event) {\r\n\r\n            if (event.ctrlKey && event.keyCode == 13) {\r\n            \r\n                self.sendMessage();\r\n            }\r\n\r\n        })(this,event);\r\n    }\r\n\r\n    componentDidCatch() {\r\n        $(\"footer\").removeClass(\"footer-fixed\");\r\n    }\r\n\r\n    render() {\r\n\r\n        const {state} = this;\r\n\r\n        return (\r\n            <div>\r\n\r\n                { /* Div com as mensagens */  }\r\n                <div className='row'>\r\n                    <div className='col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 container'>\r\n                        <div className='container-messages--style'>\r\n                       \r\n                                <div>\r\n\r\n                                    {state.messages.map((m, key) => {\r\n                                            \r\n                                        {\r\n                                            if (m.from === this.context.username && m.to !== 'todos')\r\n                                                return(<div key={key}><p><span style={{color:'red'}}>{m.from}</span> <b style={{color:'indigo'}}>disse em privado para {m.to}</b> : <span style={{color:'orange'}}>{m.message} - <span style={{color:'red'}}>{m.date}</span></span></p></div>)\r\n                                            if (m.from !== this.context.username && m.to === this.context.username)\r\n                                                return(<div key={key}><p><span style={{color:'red'}}>{m.to}</span> <b style={{color:'indigo'}}>disse em privado para vocÃª</b> : <span style={{color:'orange'}}>{m.message} - <span style={{color:'red'}}>{m.date}</span></span></p></div>)  \r\n                                            else if(m.first)\r\n                                               return(<div key={key}><p><b style={{color:'black'}}>Servidor</b> disse: <b style={{color:'orange'}}>{m.from}</b> entrou na sala! - <span style={{color:'red'}}>{m.date}</span></p></div>)\r\n                                            else if(m.disconnected && m.from) \r\n                                               return(<div key={key}><p><b style={{color:'black'}}>Servidor</b> disse: <b style={{color:'orange'}}>{m.from}</b> saiu da sala! - <span style={{color:'red'}}>{m.date}</span></p></div>)\r\n                                            else if (m.from)\r\n                                               return(<div key={key}><p><span style={{color:'red'}}>{m.from}</span> disse para <span style={{color:'indigo'}}>{m.to}</span>: <span style={{color:'orange'}}>{m.message} - <span style={{color:'red'}}>{m.date}</span></span></p></div>)\r\n                                        }   \r\n\r\n                                      \r\n                                        })}\r\n                                    <br />\r\n                                </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <br />\r\n                <div className='row'>\r\n                    <div className='col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 container'>\r\n                      <span>Bem vindo: <b style={{color:'Red'}}>{this.context.username}</b></span>\r\n                    </div>\r\n                </div>\r\n                    <br />\r\n                <div className='row'>\r\n                    <div className='col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 container'>\r\n                      <span>\r\n                            Enviar mensagem para: \r\n                            <select ref={this.to} onChange={this.handleChange} name='to' className='form-control'>\r\n\r\n                                    {\r\n                                        state.usersconnected.map((res,key) => {\r\n\r\n                                                if(res !== this.context.username)\r\n                                                  return (<option value={key}>{res}</option> )   \r\n                                        })\r\n                                    }\r\n\r\n                            </select> \r\n                        </span>\r\n                    </div>\r\n                </div>\r\n                <br />\r\n                <div className='row'>\r\n                   <div className='col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 container'>\r\n                       <textarea value={state.message} ref={this.message} onKeyDown={this.onKeyDown_Message.bind(this)} onChange={this.handleChange} name='message' autoFocus='autoFocus' maxLength='1000' cols='10' rows='10' className='form-control' placeHolder='Publique alguma coisa - Ctrl + Enter para enviar'></textarea>\r\n                    </div>\r\n                </div>              \r\n                <br />\r\n                <div className='row'>\r\n                    <div className='col-12 col-sm-12 col-md-8 col-lg-8 col-xl-8 container'>\r\n                      <button onClick={this.sendMessage} className='btn btn-primary'>Enviar</button>\r\n                    </div>\r\n                </div>  \r\n\r\n            </div>\r\n        )\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}